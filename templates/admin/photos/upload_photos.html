{% extends "base/admin_base.html" %}

{% block title %}{{ _('Bulk Photo Import') }}{% endblock %}

{% block content %}
<div class="page-header">
    <h1><i class="bi bi-cloud-upload"></i> {{ _('Bulk Photo Import') }}</h1>
    <div class="page-actions">
        <a href="{{ url_for('admin_manage_photos', token=token) }}" class="btn-back">
            <i class="bi bi-arrow-left"></i> {{ _('Back to Photos') }}
        </a>
    </div>
</div>

{% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        {% for category, message in messages %}
            <div class="alert alert-{{ category }} alert-dismissible fade show">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        {% endfor %}
    {% endif %}
{% endwith %}

<div class="card mb-4">
    <div class="card-header">
        <ul class="nav nav-tabs card-header-tabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="files-tab" data-bs-toggle="tab" data-bs-target="#files" 
                        type="button" role="tab" aria-controls="files" aria-selected="true">
                    <i class="bi bi-file-earmark-image"></i> {{ _('File Upload') }}
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="urls-tab" data-bs-toggle="tab" data-bs-target="#urls" 
                        type="button" role="tab" aria-controls="urls" aria-selected="false">
                    <i class="bi bi-link"></i> {{ _('URL Import') }}
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="bulk-tab" data-bs-toggle="tab" data-bs-target="#bulk" 
                        type="button" role="tab" aria-controls="bulk" aria-selected="false">
                    <i class="bi bi-list"></i> {{ _('Bulk Upload') }}
                </button>
            </li>
        </ul>
    </div>
    <div class="card-body">
        <div class="tab-content">
            <!-- File Upload -->
            <div class="tab-pane fade show active" id="files" role="tabpanel" aria-labelledby="files-tab">
                <form method="POST" enctype="multipart/form-data">
                    <div class="mb-3">
                        <label for="article" class="form-label">{{ _('Product Article') }}</label>
                        <input type="text" class="form-control" id="article" name="article" 
                               value="{{ request.args.get('article', '') }}" required>
                        <div class="form-text">{{ _('Enter the article of the product for which you are uploading photos') }}</div>
                    </div>
                    <div class="mb-3">
                        <label for="photos" class="form-label">{{ _('Select image files') }}</label>
                        <input type="file" class="form-control" id="photos" name="photos" 
                               accept="image/*" multiple required>
                        <div class="form-text">{{ _('You can select multiple files. Supported formats: JPG, PNG, GIF, WebP') }}</div>
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <i class="bi bi-cloud-upload"></i> {{ _('Upload Photos') }}
                    </button>
                </form>
            </div>
            
            <!-- URL Import -->
            <div class="tab-pane fade" id="urls" role="tabpanel" aria-labelledby="urls-tab">
                <form method="POST">
                    <div class="mb-3">
                        <label for="article" class="form-label">{{ _('Product Article') }}</label>
                        <input type="text" class="form-control" id="article" name="article" 
                               value="{{ request.args.get('article', '') }}" required>
                        <div class="form-text">{{ _('Enter the article of the product for which you are uploading photos') }}</div>
                    </div>
                    <div class="mb-3">
                        <label for="photo_urls" class="form-label">{{ _('Image URLs') }}</label>
                        <textarea class="form-control" id="photo_urls" name="photo_urls" 
                                  rows="5" required placeholder="https://example.com/image1.jpg
https://example.com/image2.jpg"></textarea>
                        <div class="form-text">{{ _('Enter each URL on a new line') }}</div>
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <i class="bi bi-cloud-download"></i> {{ _('Import by URL') }}
                    </button>
                </form>
            </div>
            
            <!-- Bulk Upload -->
            <div class="tab-pane fade" id="bulk" role="tabpanel" aria-labelledby="bulk-tab">
                <form method="POST">
                    <div class="mb-3">
                        <label for="images_data" class="form-label">{{ _('Image Data') }}</label>
                        <textarea class="form-control" id="images_data" name="images_data" 
                                  rows="10" required placeholder="LR014305&#9;https://image.autogroup.sk/products/LR014305.jpg
W123456&#9;https://image.autogroup.sk/products/W123456.jpg"></textarea>
                        <div class="form-text">
                            {{ _('Format: Article[TAB]URL (one per line).') }}<br>
                            {{ _('Use the tab character to separate article and URL.') }}
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <i class="bi bi-cloud-upload"></i> {{ _('Bulk Upload') }}
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>

<div class="card">
    <div class="card-header">
        <h5 class="card-title mb-0">{{ _('Instructions') }}</h5>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-4">
                <h6><i class="bi bi-file-earmark-image me-2"></i>{{ _('File Upload') }}</h6>
                <p>{{ _('Use this tab to upload photos from your computer.') }}</p>
                <ol>
                    <li>{{ _('Enter product article') }}</li>
                    <li>{{ _('Select one or more image files') }}</li>
                    <li>{{ _('Click "Upload Photos"') }}</li>
                </ol>
            </div>
            <div class="col-md-4">
                <h6><i class="bi bi-link me-2"></i>{{ _('URL Import') }}</h6>
                <p>{{ _('Use this tab to import photos by URL.') }}</p>
                <ol>
                    <li>{{ _('Enter product article') }}</li>
                    <li>{{ _('Enter image URLs (each on a new line)') }}</li>
                    <li>{{ _('Click "Import by URL"') }}</li>
                </ol>
            </div>
            <div class="col-md-4">
                <h6><i class="bi bi-list me-2"></i>{{ _('Bulk Upload') }}</h6>
                <p>{{ _('Use for bulk uploading for multiple products.') }}</p>
                <ol>
                    <li>{{ _('Enter data in Article[TAB]URL format') }}</li>
                    <li>{{ _('Each product on a new line') }}</li>
                    <li>{{ _('Click "Bulk Upload"') }}</li>
                </ol>
            </div>
        </div>
    </div>
</div>
{% endblock %}
