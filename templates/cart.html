<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Cart</title>
    <link rel="stylesheet" href="/static/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <header>
        <nav>
            <ul>
                <li><a href="/">Home</a></li>
                <li><a href="/cart">Cart</a></li>
            </ul>
        </nav>
    </header>
	<div class="container">
		<h1>Your Cart</h1>
		
		<!-- Відображення Flash-повідомлень -->
		{% with messages = get_flashed_messages(with_categories=true) %}
			{% if messages %}
			<div class="flash-messages">
				{% for category, message in messages %}
				<div class="flash-message {{ category }}">
					{{ message }}
				</div>
				{% endfor %}
			</div>
			{% endif %}
		{% endwith %}
		
		{% if cart_items %}
		<table>
			<thead>
				<tr>
					<th>Article</th>
					<th>Price</th>
					<th>Quantity</th>
					<th>Total</th>
					<th>Actions</th>
				</tr>
			</thead>
			<tbody>
				{% for item in cart_items %}
				<tr>
					<td>{{ item.article }}</td>
					<td>{{ item.price }}</td>
					<td>
						<form method="POST" action="/update_cart">
							<input type="hidden" name="article" value="{{ item.article }}">
							<input type="hidden" name="product_id" value="{{ item.product_id }}">
							<input type="number" name="quantity" value="{{ item.quantity }}" min="1">
							<button type="submit" class="update-button">
								<i class="fas fa-edit"></i> Update
							</button>
						</form>
					</td>
					<td>{{ item.total_price }}</td>
					<td>
						<form method="POST" action="/remove_from_cart">
							<input type="hidden" name="article" value="{{ item.article }}">
							<input type="hidden" name="product_id" value="{{ item.product_id }}">
							<button type="submit" class="remove-button">
								<i class="fas fa-trash"></i> Remove
							</button>
						</form>
					</td>
				</tr>
				{% endfor %}
			</tbody>
		</table>

		<!-- Кнопки очищення кошика та оформлення замовлення -->
		<div class="navigation-buttons">
			<form method="POST" action="/clear_cart">
				<button type="submit" class="clear-cart-button">Clear Cart</button>
			</form>
			<form method="POST" action="/place_order">
				<button type="submit" class="place-order-button">Place Order</button>
			</form>
		</div>
		{% else %}
		<p>Your cart is empty.</p>
		<div class="navigation-buttons">
			<button onclick="window.location.href='/'">Back to Search</button>
		</div>
		{% endif %}
	</div>
</body>
</html>
